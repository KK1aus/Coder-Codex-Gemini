# Coder-Reviewer-MCP

> Claude (Opus) + Coder (claude-glm/GLM-4.7) + Reviewer (Gemini) å¤šæ¨¡å‹åä½œ MCP æœåŠ¡å™¨

## é¡¹ç›®å®šä½

ä¸€ä¸ªç»Ÿä¸€çš„ MCP æœåŠ¡å™¨ï¼Œè®© Claude (Opus) ä½œä¸ºæ¶æ„å¸ˆè°ƒåº¦ Coder (claude-glm/GLM-4.7) æ‰§è¡Œä»£ç ä»»åŠ¡ã€Reviewer (Gemini) å®¡æ ¸ä»£ç è´¨é‡ï¼Œå½¢æˆè‡ªåŠ¨åŒ–çš„å¤šæ–¹åä½œé—­ç¯ã€‚

## æ ¸å¿ƒä»·å€¼

| ç»´åº¦ | ä»·å€¼ |
|------|------|
| **æˆæœ¬ä¼˜åŒ–** | Opus è´Ÿè´£æ€è€ƒï¼ˆè´µä½†å¼ºï¼‰ï¼ŒCoder è´Ÿè´£æ‰§è¡Œï¼ˆé‡å¤§ç®¡é¥±ï¼‰ |
| **èƒ½åŠ›äº’è¡¥** | Opus è¡¥è¶³ Coder åˆ›é€ åŠ›çŸ­æ¿ï¼ŒReviewer (Gemini) æä¾›ç‹¬ç«‹å®¡æ ¸è§†è§’ |
| **è´¨é‡ä¿éšœ** | åŒé‡å®¡æ ¸æœºåˆ¶ï¼ˆClaude åˆå®¡ + Reviewer ç»ˆå®¡ï¼‰ |
| **å…¨è‡ªåŠ¨é—­ç¯** | æ‹†è§£ â†’ æ‰§è¡Œ â†’ å®¡æ ¸ â†’ é‡è¯•ï¼Œæ— éœ€äººå·¥å¹²é¢„ |

## è§’è‰²åˆ†å·¥

```
Claude (Opus)        â†’  æ¶æ„å¸ˆ + åˆå®¡å®˜ + ç»ˆå®¡å®˜ + åè°ƒè€…
Coder (claude-glm)   â†’  ä»£ç æ‰§è¡Œè€…ï¼ˆGLM-4.7ï¼Œç”Ÿæˆã€ä¿®æ”¹ã€æ‰¹é‡ä»»åŠ¡ï¼‰
Reviewer (Gemini)    â†’  ç‹¬ç«‹ä»£ç å®¡æ ¸è€…ï¼ˆè´¨é‡æŠŠå…³ï¼‰
```

## é¡¹ç›®ç»“æ„

```
Coder-Reviewer-MCP/
â”œâ”€â”€ src/ccg_mcp/              # æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ cli.py                # å…¥å£ç‚¹
â”‚   â”œâ”€â”€ server.py             # MCP æœåŠ¡å™¨ä¸»ä½“
â”‚   â”œâ”€â”€ config.py             # é…ç½®åŠ è½½ï¼ˆç®€åŒ–ç‰ˆï¼‰
â”‚   â””â”€â”€ tools/
â”‚       â”œâ”€â”€ coder.py          # Coder å·¥å…·ï¼ˆclaude-glm CLIï¼‰
â”‚       â””â”€â”€ reviewer.py       # Reviewer å·¥å…·ï¼ˆgemini CLIï¼‰
â”œâ”€â”€ skills/                   # Skills å·¥ä½œæµæŒ‡å¯¼
â”‚   â””â”€â”€ ccg-workflow/         # CCG åä½œæµç¨‹
â”œâ”€â”€ cases/                    # å®æµ‹æ¡ˆä¾‹
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜ï¼ˆä¸­æ–‡ï¼‰
â”œâ”€â”€ README_EN.md              # é¡¹ç›®è¯´æ˜ï¼ˆè‹±æ–‡ï¼‰
â””â”€â”€ CLAUDE.md                 # æœ¬æ–‡ä»¶
```

## å¼€å‘é‡Œç¨‹ç¢‘

| é˜¶æ®µ | å†…å®¹ | çŠ¶æ€ |
|------|------|------|
| M0 | æ–¹æ¡ˆè®¾è®¡ã€æŠ€æœ¯éªŒè¯ | âœ… å®Œæˆ |
| M1 | æœ€å°å¯ç”¨ç‰ˆæœ¬ï¼ˆcoder å·¥å…·ï¼‰ | âœ… å®Œæˆ |
| M2 | é›†æˆ reviewer å·¥å…· | âœ… å®Œæˆ |
| M3 | åä½œ Prompt ä¼˜åŒ– | âœ… å®Œæˆ |
| M4 | é‡æ„ä¸º Coder-Reviewer-MCP | âœ… å®Œæˆ |
| M5 | æ–‡æ¡£ã€å‘å¸ƒ | âœ… å®Œæˆ |

## æŠ€æœ¯è¦ç‚¹

### MCP å·¥å…·

- `coder`: è°ƒç”¨ claude-glm CLI æ‰§è¡Œä»£ç ç”Ÿæˆ/ä¿®æ”¹ï¼Œé»˜è®¤ `workspace-write`
- `reviewer`: è°ƒç”¨ Gemini CLI è¿›è¡Œä»£ç å®¡æ ¸ï¼Œé»˜è®¤ `read-only`

### æ ¸å¿ƒç‰¹æ€§

#### ç»“æ„åŒ–é”™è¯¯
å¤±è´¥æ—¶è¿”å› `error_kind` å’Œ `error_detail`ï¼Œä¾¿äºä¸Šå±‚å†³ç­–æ˜¯å¦é‡è¯•ï¼š
```json
{
  "success": false,
  "error": "é”™è¯¯æ‘˜è¦",
  "error_kind": "timeout | upstream_error | ...",
  "error_detail": {
    "message": "é”™è¯¯ç®€è¿°",
    "exit_code": 1,
    "last_lines": ["æœ€å50è¡Œè¾“å‡º..."],
    "retries": 0
  }
}
```

#### é‡è¯•ç­–ç•¥
- **Reviewer (Gemini)**ï¼šé»˜è®¤å…è®¸ 1 æ¬¡é‡è¯•ï¼ˆåªè¯»æ“ä½œæ— å‰¯ä½œç”¨ï¼‰
- **Coder (claude-glm)**ï¼šé»˜è®¤ä¸é‡è¯•ï¼ˆæœ‰å†™å…¥å‰¯ä½œç”¨ï¼‰ï¼Œå¯é€šè¿‡ `max_retries` æ˜¾å¼å¯ç”¨

#### å¯è§‚å¯Ÿæ€§æŒ‡æ ‡
- `return_metrics=True`ï¼šåœ¨è¿”å›å€¼ä¸­åŒ…å«è€—æ—¶ã€Prompt é•¿åº¦ç­‰æŒ‡æ ‡
- `log_metrics=True`ï¼šå°†æŒ‡æ ‡è¾“å‡ºåˆ° stderrï¼ˆJSONL æ ¼å¼ï¼‰

#### å‘½ä»¤è¡Œå‚æ•°ç­–ç•¥
- **System Prompt**ï¼š`--append-system-prompt` é€šè¿‡å‘½ä»¤è¡Œå‚æ•°è¿½åŠ è§’è‰²æŒ‡ä»¤
- **å¯¹è¯ Prompt**ï¼šé€šè¿‡ stdin ä¼ é€’ï¼ˆæ”¯æŒæ¢è¡Œç¬¦ï¼Œæ— é•¿åº¦é™åˆ¶ï¼‰

### CLI å·¥å…·é…ç½®

- **claude-glm CLI**: éœ€è¦å•ç‹¬å®‰è£…å¹¶é…ç½®ï¼ˆGLM-4.7 æ¨¡å‹å°è£…ï¼‰
- **Gemini CLI**: éœ€è¦å•ç‹¬å®‰è£…å¹¶é…ç½®ï¼ˆGoogle Geminiï¼‰

### è·¨å¹³å°å®ç°

é€šè¿‡ `subprocess.Popen()` è°ƒç”¨ CLI å·¥å…·ï¼Œæ— éœ€ä¾èµ–è„šæœ¬æ–‡ä»¶ã€‚

## å‚è€ƒèµ„æº

- [FastMCP](https://github.com/jlowin/fastmcp) - MCP æ¡†æ¶
- [Claude Code CLI](https://docs.anthropic.com/en/docs/claude-code)
- [Gemini CLI](https://github.com/google-gemini/gemini-cli)

---

> ğŸ“… é¡¹ç›®åˆ›å»º: 2026-01-01
> ğŸ“… é‡å‘½åä¸º Coder-Reviewer-MCP: 2026-01-20
